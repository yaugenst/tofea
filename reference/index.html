
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Reference - TOFEA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TOFEA" class="md-header__button md-logo" aria-label="TOFEA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TOFEA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mrbaozi/tofea" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TOFEA" class="md-nav__button md-logo" aria-label="TOFEA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TOFEA
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mrbaozi/tofea" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tofea" class="md-nav__link">
    <span class="md-ellipsis">
      tofea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements" class="md-nav__link">
    <span class="md-ellipsis">
      elements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Element" class="md-nav__link">
    <span class="md-ellipsis">
      Element
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element" class="md-nav__link">
    <span class="md-ellipsis">
      Q4Element
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Q4Element">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element.gauss_points" class="md-nav__link">
    <span class="md-ellipsis">
      gauss_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element.grad_shape_funcs" class="md-nav__link">
    <span class="md-ellipsis">
      grad_shape_funcs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_K" class="md-nav__link">
    <span class="md-ellipsis">
      Q4Element_K
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Q4Element_K">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_K.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_T" class="md-nav__link">
    <span class="md-ellipsis">
      Q4Element_T
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Q4Element_T">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_T.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d" class="md-nav__link">
    <span class="md-ellipsis">
      fea2d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D" class="md-nav__link">
    <span class="md-ellipsis">
      FEA2D
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FEA2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.dofs" class="md-nav__link">
    <span class="md-ellipsis">
      dofs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.e2sdofmap" class="md-nav__link">
    <span class="md-ellipsis">
      e2sdofmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.e2sdofmap_reshaped" class="md-nav__link">
    <span class="md-ellipsis">
      e2sdofmap_reshaped
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.fixdofs" class="md-nav__link">
    <span class="md-ellipsis">
      fixdofs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.freedofs" class="md-nav__link">
    <span class="md-ellipsis">
      freedofs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.index_map" class="md-nav__link">
    <span class="md-ellipsis">
      index_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.keep_indices" class="md-nav__link">
    <span class="md-ellipsis">
      keep_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.shape" class="md-nav__link">
    <span class="md-ellipsis">
      shape
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.global_mat" class="md-nav__link">
    <span class="md-ellipsis">
      global_mat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.solve" class="md-nav__link">
    <span class="md-ellipsis">
      solve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K" class="md-nav__link">
    <span class="md-ellipsis">
      FEA2D_K
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FEA2D_K">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.dofmap" class="md-nav__link">
    <span class="md-ellipsis">
      dofmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.compliance" class="md-nav__link">
    <span class="md-ellipsis">
      compliance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.displacement" class="md-nav__link">
    <span class="md-ellipsis">
      displacement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T" class="md-nav__link">
    <span class="md-ellipsis">
      FEA2D_T
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FEA2D_T">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T.dofmap" class="md-nav__link">
    <span class="md-ellipsis">
      dofmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T.temperature" class="md-nav__link">
    <span class="md-ellipsis">
      temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives" class="md-nav__link">
    <span class="md-ellipsis">
      primitives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_b_jvp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_b_jvp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_b_vjp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_b_vjp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_entries_jvp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_entries_jvp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_entries_vjp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_entries_vjp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers" class="md-nav__link">
    <span class="md-ellipsis">
      solvers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers.Solver" class="md-nav__link">
    <span class="md-ellipsis">
      Solver
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU" class="md-nav__link">
    <span class="md-ellipsis">
      SuperLU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SuperLU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.clear" class="md-nav__link">
    <span class="md-ellipsis">
      clear
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.factor" class="md-nav__link">
    <span class="md-ellipsis">
      factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.solve" class="md-nav__link">
    <span class="md-ellipsis">
      solve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers.get_solver" class="md-nav__link">
    <span class="md-ellipsis">
      get_solver
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tofea" class="md-nav__link">
    <span class="md-ellipsis">
      tofea
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements" class="md-nav__link">
    <span class="md-ellipsis">
      elements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Element" class="md-nav__link">
    <span class="md-ellipsis">
      Element
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element" class="md-nav__link">
    <span class="md-ellipsis">
      Q4Element
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Q4Element">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element.gauss_points" class="md-nav__link">
    <span class="md-ellipsis">
      gauss_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element.grad_shape_funcs" class="md-nav__link">
    <span class="md-ellipsis">
      grad_shape_funcs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_K" class="md-nav__link">
    <span class="md-ellipsis">
      Q4Element_K
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Q4Element_K">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_K.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_T" class="md-nav__link">
    <span class="md-ellipsis">
      Q4Element_T
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Q4Element_T">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.elements.Q4Element_T.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d" class="md-nav__link">
    <span class="md-ellipsis">
      fea2d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D" class="md-nav__link">
    <span class="md-ellipsis">
      FEA2D
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FEA2D">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.dofs" class="md-nav__link">
    <span class="md-ellipsis">
      dofs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.e2sdofmap" class="md-nav__link">
    <span class="md-ellipsis">
      e2sdofmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.e2sdofmap_reshaped" class="md-nav__link">
    <span class="md-ellipsis">
      e2sdofmap_reshaped
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.fixdofs" class="md-nav__link">
    <span class="md-ellipsis">
      fixdofs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.freedofs" class="md-nav__link">
    <span class="md-ellipsis">
      freedofs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.index_map" class="md-nav__link">
    <span class="md-ellipsis">
      index_map
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.keep_indices" class="md-nav__link">
    <span class="md-ellipsis">
      keep_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.shape" class="md-nav__link">
    <span class="md-ellipsis">
      shape
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.global_mat" class="md-nav__link">
    <span class="md-ellipsis">
      global_mat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D.solve" class="md-nav__link">
    <span class="md-ellipsis">
      solve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K" class="md-nav__link">
    <span class="md-ellipsis">
      FEA2D_K
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FEA2D_K">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.dofmap" class="md-nav__link">
    <span class="md-ellipsis">
      dofmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.compliance" class="md-nav__link">
    <span class="md-ellipsis">
      compliance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_K.displacement" class="md-nav__link">
    <span class="md-ellipsis">
      displacement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T" class="md-nav__link">
    <span class="md-ellipsis">
      FEA2D_T
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FEA2D_T">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T.dofmap" class="md-nav__link">
    <span class="md-ellipsis">
      dofmap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T.element" class="md-nav__link">
    <span class="md-ellipsis">
      element
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.fea2d.FEA2D_T.temperature" class="md-nav__link">
    <span class="md-ellipsis">
      temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives" class="md-nav__link">
    <span class="md-ellipsis">
      primitives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_b_jvp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_b_jvp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_b_vjp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_b_vjp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_entries_jvp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_entries_jvp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.primitives.solve_coo_entries_vjp" class="md-nav__link">
    <span class="md-ellipsis">
      solve_coo_entries_vjp
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers" class="md-nav__link">
    <span class="md-ellipsis">
      solvers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers.Solver" class="md-nav__link">
    <span class="md-ellipsis">
      Solver
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU" class="md-nav__link">
    <span class="md-ellipsis">
      SuperLU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SuperLU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.clear" class="md-nav__link">
    <span class="md-ellipsis">
      clear
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.factor" class="md-nav__link">
    <span class="md-ellipsis">
      factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tofea.solvers.SuperLU.solve" class="md-nav__link">
    <span class="md-ellipsis">
      solve
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tofea.solvers.get_solver" class="md-nav__link">
    <span class="md-ellipsis">
      get_solver
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="api-reference">API Reference</h1>
<p>This section contains the automatically generated API reference. Each module is
documented with <a href="https://mkdocstrings.github.io/"><code>mkdocstrings</code></a> and the
examples included in the docstrings are executed as doctests during continuous
integration to ensure they remain correct.</p>


<div class="doc doc-object doc-module">



<a id="tofea"></a>
    <div class="doc doc-contents first">

        <p>Light-weight, differentiable finite element analysis package.</p>









  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="tofea.elements"></a>
    <div class="doc doc-contents first">

        <p>Finite element primitives used by :mod:<code>tofea</code>.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="tofea.elements.Element" class="doc doc-heading">
            <code>Element</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Base dataclass for finite elements.</p>







              <details class="quote">
                <summary>Source code in <code>tofea/elements.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Element</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base dataclass for finite elements.&quot;&quot;&quot;</span>

    <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">dz</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">eps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="tofea.elements.Q4Element" class="doc doc-heading">
            <code>Q4Element</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Element


  
      dataclass
   (tofea.elements.Element)" href="#tofea.elements.Element">Element</a></code></p>


        <p>Four-node quadrilateral element.</p>
<p>This class provides utilities shared by all quadrilateral elements
implemented in :mod:<code>tofea</code>, namely Gauss quadrature points and the
gradients of the bilinear shape functions.  Having these helpers in a
common base class avoids code duplication in the concrete element
implementations and gives this abstraction a clear purpose.</p>







              <details class="quote">
                <summary>Source code in <code>tofea/elements.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Q4Element</span><span class="p">(</span><span class="n">Element</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Four-node quadrilateral element.</span>

<span class="sd">    This class provides utilities shared by all quadrilateral elements</span>
<span class="sd">    implemented in :mod:`tofea`, namely Gauss quadrature points and the</span>
<span class="sd">    gradients of the bilinear shape functions.  Having these helpers in a</span>
<span class="sd">    common base class avoids code duplication in the concrete element</span>
<span class="sd">    implementations and gives this abstraction a clear purpose.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">gauss_points</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the points for 2x2 Gauss quadrature.&quot;&quot;&quot;</span>

        <span class="n">gp</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[(</span><span class="o">-</span><span class="n">gp</span><span class="p">,</span> <span class="o">-</span><span class="n">gp</span><span class="p">),</span> <span class="p">(</span><span class="n">gp</span><span class="p">,</span> <span class="o">-</span><span class="n">gp</span><span class="p">),</span> <span class="p">(</span><span class="n">gp</span><span class="p">,</span> <span class="n">gp</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">gp</span><span class="p">,</span> <span class="n">gp</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">grad_shape_funcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return shape function gradients for local coordinates.&quot;&quot;&quot;</span>

        <span class="n">dN_dxi</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">eta</span><span class="p">),</span>
                <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">eta</span><span class="p">),</span>
                <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">eta</span><span class="p">),</span>
                <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">eta</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">dN_deta</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="p">),</span>
                <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi</span><span class="p">),</span>
                <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi</span><span class="p">),</span>
                <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">dN_dxi</span><span class="p">,</span> <span class="n">dN_deta</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="tofea.elements.Q4Element.gauss_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gauss_points</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the points for 2x2 Gauss quadrature.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/elements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gauss_points</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the points for 2x2 Gauss quadrature.&quot;&quot;&quot;</span>

    <span class="n">gp</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[(</span><span class="o">-</span><span class="n">gp</span><span class="p">,</span> <span class="o">-</span><span class="n">gp</span><span class="p">),</span> <span class="p">(</span><span class="n">gp</span><span class="p">,</span> <span class="o">-</span><span class="n">gp</span><span class="p">),</span> <span class="p">(</span><span class="n">gp</span><span class="p">,</span> <span class="n">gp</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="n">gp</span><span class="p">,</span> <span class="n">gp</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="tofea.elements.Q4Element.grad_shape_funcs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">grad_shape_funcs</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return shape function gradients for local coordinates.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/elements.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">grad_shape_funcs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xi</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">eta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return shape function gradients for local coordinates.&quot;&quot;&quot;</span>

    <span class="n">dN_dxi</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">eta</span><span class="p">),</span>
            <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">eta</span><span class="p">),</span>
            <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">eta</span><span class="p">),</span>
            <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">eta</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">dN_deta</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="p">),</span>
            <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi</span><span class="p">),</span>
            <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">xi</span><span class="p">),</span>
            <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">dN_dxi</span><span class="p">,</span> <span class="n">dN_deta</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="tofea.elements.Q4Element_K" class="doc doc-heading">
            <code>Q4Element_K</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Q4Element


  
      dataclass
   (tofea.elements.Q4Element)" href="#tofea.elements.Q4Element">Q4Element</a></code></p>


        <p>Plane stress elasticity element.</p>







              <details class="quote">
                <summary>Source code in <code>tofea/elements.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Q4Element_K</span><span class="p">(</span><span class="n">Q4Element</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plane stress elasticity element.&quot;&quot;&quot;</span>

    <span class="n">e</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">nu</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 8x8 stiffness matrix for the element.</span>

<span class="sd">        The matrix is assembled using 2x2 Gauss quadrature instead of the</span>
<span class="sd">        symbolic integration previously used.  This avoids the costly SymPy</span>
<span class="sd">        computations and speeds up object construction significantly while</span>
<span class="sd">        maintaining numerical precision.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            Stiffness matrix of shape ``(8, 8)``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tofea.elements import Q4Element_K</span>
<span class="sd">        &gt;&gt;&gt; Q4Element_K().element.shape</span>
<span class="sd">        (8, 8)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">C</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nu</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">K</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">eta</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">():</span>
            <span class="n">dN_dxi</span><span class="p">,</span> <span class="n">dN_deta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_shape_funcs</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>

            <span class="n">B</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN_dxi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span>
                <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN_deta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span>
                <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN_deta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span>
                <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN_dxi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span>

            <span class="n">K</span> <span class="o">+=</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">C</span> <span class="o">@</span> <span class="n">B</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span>

        <span class="n">K</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">K</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="tofea.elements.Q4Element_K.element" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">element</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the 8x8 stiffness matrix for the element.</p>
<p>The matrix is assembled using 2x2 Gauss quadrature instead of the
symbolic integration previously used.  This avoids the costly SymPy
computations and speeds up object construction significantly while
maintaining numerical precision.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Stiffness matrix of shape <code>(8, 8)</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tofea.elements</span><span class="w"> </span><span class="kn">import</span> <span class="n">Q4Element_K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q4Element_K</span><span class="p">()</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(8, 8)</span>
</code></pre></div>

    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="tofea.elements.Q4Element_T" class="doc doc-heading">
            <code>Q4Element_T</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Q4Element


  
      dataclass
   (tofea.elements.Q4Element)" href="#tofea.elements.Q4Element">Q4Element</a></code></p>


        <p>Heat conductivity element.</p>







              <details class="quote">
                <summary>Source code in <code>tofea/elements.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slots</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Q4Element_T</span><span class="p">(</span><span class="n">Q4Element</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Heat conductivity element.&quot;&quot;&quot;</span>

    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the 4x4 conductivity matrix for the element.</span>

<span class="sd">        Similar to :class:`Q4Element_K`, the matrix is assembled numerically</span>
<span class="sd">        using 2x2 Gauss quadrature.  This removes the dependency on SymPy for</span>
<span class="sd">        runtime calculations and considerably reduces initialization time.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            Conductivity matrix of shape ``(4, 4)``.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from tofea.elements import Q4Element_T</span>
<span class="sd">        &gt;&gt;&gt; Q4Element_T().element.shape</span>
<span class="sd">        (4, 4)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">C</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="n">K</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">xi</span><span class="p">,</span> <span class="n">eta</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">gauss_points</span><span class="p">():</span>
            <span class="n">dN_dxi</span><span class="p">,</span> <span class="n">dN_deta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grad_shape_funcs</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">eta</span><span class="p">)</span>

            <span class="n">B</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
                <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN_dxi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span>
                <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dN_deta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span>

            <span class="n">K</span> <span class="o">+=</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">C</span> <span class="o">@</span> <span class="n">B</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dy</span>

        <span class="n">K</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">eps</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">K</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="tofea.elements.Q4Element_T.element" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">element</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return the 4x4 conductivity matrix for the element.</p>
<p>Similar to :class:<code>Q4Element_K</code>, the matrix is assembled numerically
using 2x2 Gauss quadrature.  This removes the dependency on SymPy for
runtime calculations and considerably reduces initialization time.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Conductivity matrix of shape <code>(4, 4)</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tofea.elements</span><span class="w"> </span><span class="kn">import</span> <span class="n">Q4Element_T</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Q4Element_T</span><span class="p">()</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 4)</span>
</code></pre></div>

    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="tofea.fea2d"></a>
    <div class="doc doc-contents first">

        <p>Finite element solvers for 2D problems.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="tofea.fea2d.FEA2D" class="doc doc-heading">
            <code>FEA2D</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for 2D finite element models.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fixed</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.bool_">bool_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Boolean mask indicating which degrees of freedom are fixed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the backend solver to use.</p>
              </div>
            </td>
            <td>
                  <code><span title="tofea.DEFAULT_SOLVER">DEFAULT_SOLVER</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dx</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Element dimensions in <code>x</code> and <code>y</code> direction.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dy</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Element dimensions in <code>x</code> and <code>y</code> direction.</p>
              </div>
            </td>
            <td>
                  <code>0.5</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Notes</summary>
  <p>Subclasses must provide the element matrix and a mapping from element
degrees of freedom to system degrees of freedom.</p>
</details>






              <details class="quote">
                <summary>Source code in <code>tofea/fea2d.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FEA2D</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for 2D finite element models.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fixed</span>
<span class="sd">        Boolean mask indicating which degrees of freedom are fixed.</span>
<span class="sd">    solver</span>
<span class="sd">        Name of the backend solver to use.</span>
<span class="sd">    dx, dy</span>
<span class="sd">        Element dimensions in ``x`` and ``y`` direction.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Subclasses must provide the element matrix and a mapping from element</span>
<span class="sd">    degrees of freedom to system degrees of freedom.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fixed</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]</span>
    <span class="n">solver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_SOLVER</span>
    <span class="n">dx</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">dy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dof_dim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dofmap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span> <span class="o">...</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of elements in :math:`x` and :math:`y` direction.&quot;&quot;&quot;</span>

        <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dofs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Indices of all degrees of freedom.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fixdofs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Indices of fixed degrees of freedom.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dofs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">freedofs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Indices of free degrees of freedom.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dofs</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_solver</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Solver</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Backend solver instance.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">get_solver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">index_map</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Permutation that places free DOFs first.&quot;&quot;&quot;</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">freedofs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fixdofs</span><span class="p">])</span>
        <span class="n">imap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dofs</span><span class="p">)</span>
        <span class="n">imap</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dofs</span>
        <span class="k">return</span> <span class="n">imap</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">e2sdofmap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Map each element to its system DOF indices.&quot;&quot;&quot;</span>

        <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nx</span> <span class="o">*</span> <span class="n">ny</span><span class="p">),</span> <span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">))</span>
        <span class="n">idxs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof_dim</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">ny</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dofmap</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="n">idxs</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">))</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">e2sdofmap_reshaped</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Element mapping reshaped for tensor operations.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e2sdofmap</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">keep_indices</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Indices for assembling the global matrix.&quot;&quot;&quot;</span>

        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dofmap</span><span class="p">)),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dofmap</span><span class="p">)))</span>
        <span class="n">ix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e2sdofmap</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">iy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e2sdofmap</span><span class="p">[:,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freedofs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">iy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">freedofs</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">index_map</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="n">keep</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_map</span><span class="p">[</span><span class="n">iy</span><span class="p">][</span><span class="n">keep</span><span class="p">]])</span>
        <span class="k">return</span> <span class="n">keep</span><span class="p">,</span> <span class="n">indices</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">global_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assemble global matrix from element data.&quot;&quot;&quot;</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">keep</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_indices</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="n">keep</span><span class="p">],</span> <span class="n">indices</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Solve ``K(x) u = b`` for ``u``.&quot;&quot;&quot;</span>

        <span class="n">data</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">u_nz</span> <span class="o">=</span> <span class="n">solve_coo</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">freedofs</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solver</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">u_nz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixdofs</span><span class="p">))])[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_map</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">u</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.dofs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dofs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Indices of all degrees of freedom.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.e2sdofmap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">e2sdofmap</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Map each element to its system DOF indices.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.e2sdofmap_reshaped" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">e2sdofmap_reshaped</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Element mapping reshaped for tensor operations.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.fixdofs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fixdofs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Indices of fixed degrees of freedom.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.freedofs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">freedofs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Indices of free degrees of freedom.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.index_map" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">index_map</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Permutation that places free DOFs first.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.keep_indices" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">keep_indices</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Indices for assembling the global matrix.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D.shape" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shape</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Number of elements in :math:<code>x</code> and :math:<code>y</code> direction.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="tofea.fea2d.FEA2D.global_mat" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">global_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Assemble global matrix from element data.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/fea2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">global_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assemble global matrix from element data.&quot;&quot;&quot;</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">keep</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_indices</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="n">keep</span><span class="p">],</span> <span class="n">indices</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="tofea.fea2d.FEA2D.solve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Solve <code>K(x) u = b</code> for <code>u</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/fea2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solve ``K(x) u = b`` for ``u``.&quot;&quot;&quot;</span>

    <span class="n">data</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_mat</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">u_nz</span> <span class="o">=</span> <span class="n">solve_coo</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">ravel</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">freedofs</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solver</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">u_nz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixdofs</span><span class="p">))])[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_map</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">u</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="tofea.fea2d.FEA2D_K" class="doc doc-heading">
            <code>FEA2D_K</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FEA2D


  
      dataclass
   (tofea.fea2d.FEA2D)" href="#tofea.fea2d.FEA2D">FEA2D</a></code></p>


        <p>Finite element model for compliance problems.</p>
<p>This model solves small deformation elasticity problems using bilinear
quadrilateral elements.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fixed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fem</span> <span class="o">=</span> <span class="n">FEA2D_K</span><span class="p">(</span><span class="n">fixed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fem</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(8, 8)</span>
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>tofea/fea2d.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FEA2D_K</span><span class="p">(</span><span class="n">FEA2D</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finite element model for compliance problems.</span>

<span class="sd">    This model solves small deformation elasticity problems using bilinear</span>
<span class="sd">    quadrilateral elements.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; fixed = np.zeros((2, 2, 2), dtype=bool)</span>
<span class="sd">    &gt;&gt;&gt; fem = FEA2D_K(fixed)</span>
<span class="sd">    &gt;&gt;&gt; fem.element.shape</span>
<span class="sd">    (8, 8)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dof_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">e</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">nu</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Element stiffness matrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Q4Element_K</span><span class="p">(</span><span class="n">e</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">nu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nu</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span><span class="o">.</span><span class="n">element</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dofmap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of element DOFs to system DOFs.&quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">nely</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">nely</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">nely</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">displacement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return displacement field for density ``x`` and load ``b``.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">displacement</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compliance objective for ``x`` and ``displacement``.&quot;&quot;&quot;</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
            <span class="s2">&quot;ixy,ij,jxy-&gt;xy&quot;</span><span class="p">,</span>
            <span class="n">displacement</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">e2sdofmap_reshaped</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
            <span class="n">displacement</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">e2sdofmap_reshaped</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">anp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D_K.dofmap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dofmap</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Mapping of element DOFs to system DOFs.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D_K.element" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">element</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Element stiffness matrix.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="tofea.fea2d.FEA2D_K.compliance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compliance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">displacement</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compliance objective for <code>x</code> and <code>displacement</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/fea2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compliance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">displacement</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compliance objective for ``x`` and ``displacement``.&quot;&quot;&quot;</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">anp</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span>
        <span class="s2">&quot;ixy,ij,jxy-&gt;xy&quot;</span><span class="p">,</span>
        <span class="n">displacement</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">e2sdofmap_reshaped</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span>
        <span class="n">displacement</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">e2sdofmap_reshaped</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">anp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="tofea.fea2d.FEA2D_K.displacement" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">displacement</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return displacement field for density <code>x</code> and load <code>b</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/fea2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">displacement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return displacement field for density ``x`` and load ``b``.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="tofea.fea2d.FEA2D_T" class="doc doc-heading">
            <code>FEA2D_T</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="FEA2D


  
      dataclass
   (tofea.fea2d.FEA2D)" href="#tofea.fea2d.FEA2D">FEA2D</a></code></p>


        <p>Finite element model for heat conduction problems.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fixed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fem</span> <span class="o">=</span> <span class="n">FEA2D_T</span><span class="p">(</span><span class="n">fixed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fem</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 4)</span>
</code></pre></div>







              <details class="quote">
                <summary>Source code in <code>tofea/fea2d.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FEA2D_T</span><span class="p">(</span><span class="n">FEA2D</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finite element model for heat conduction problems.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; fixed = np.zeros((2, 2), dtype=bool)</span>
<span class="sd">    &gt;&gt;&gt; fem = FEA2D_T(fixed)</span>
<span class="sd">    &gt;&gt;&gt; fem.element.shape</span>
<span class="sd">    (4, 4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dof_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Element conductivity matrix.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Q4Element_T</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dy</span><span class="p">)</span><span class="o">.</span><span class="n">element</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dofmap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mapping of element DOFs to system DOFs.&quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">nely</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">nely</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">nely</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return temperature field for density ``x`` and load ``b``.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D_T.dofmap" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dofmap</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Mapping of element DOFs to system DOFs.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="tofea.fea2d.FEA2D_T.element" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">element</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Element conductivity matrix.</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="tofea.fea2d.FEA2D_T.temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">temperature</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return temperature field for density <code>x</code> and load <code>b</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/fea2d.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return temperature field for density ``x`` and load ``b``.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="tofea.primitives"></a>
    <div class="doc doc-contents first">

        <p>Autograd primitives used by the finite element routines.</p>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="tofea.primitives.solve_coo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_coo</span><span class="p">(</span><span class="n">entries</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Solve a sparse linear system in COO format.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>entries</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Non-zero matrix entries.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>indices</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span>[<span title="array">array</span> - <span title="like">like</span>, <span title="array">array</span> - <span title="like">like</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Row and column indices for <code>entries</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rhs</code>
            </td>
            <td>
                  <code><span title="array">array</span> - <span title="like">like</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Right-hand side vector.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Solver (tofea.solvers.Solver)" href="#tofea.solvers.Solver">Solver</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Factorization backend used to solve the system.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Solution vector.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">coo_matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tofea.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">solve_coo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tofea.solvers</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_solver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solve_coo</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">col</span><span class="p">),</span> <span class="n">b</span><span class="p">,</span> <span class="n">get_solver</span><span class="p">(</span><span class="s2">&quot;SuperLU&quot;</span><span class="p">))</span>
<span class="go">array([0.09090909, 0.63636364])</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>tofea/primitives.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@primitive</span>
<span class="k">def</span><span class="w"> </span><span class="nf">solve_coo</span><span class="p">(</span>
    <span class="n">entries</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">indices</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">]],</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solve a sparse linear system in COO format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    entries : array-like</span>
<span class="sd">        Non-zero matrix entries.</span>
<span class="sd">    indices : tuple[array-like, array-like]</span>
<span class="sd">        Row and column indices for ``entries``.</span>
<span class="sd">    rhs : array-like</span>
<span class="sd">        Right-hand side vector.</span>
<span class="sd">    solver : tofea.solvers.Solver</span>
<span class="sd">        Factorization backend used to solve the system.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    numpy.ndarray</span>
<span class="sd">        Solution vector.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.sparse import coo_matrix</span>
<span class="sd">    &gt;&gt;&gt; from tofea.primitives import solve_coo</span>
<span class="sd">    &gt;&gt;&gt; from tofea.solvers import get_solver</span>
<span class="sd">    &gt;&gt;&gt; m = coo_matrix([[4, 1], [1, 3]])</span>
<span class="sd">    &gt;&gt;&gt; b = np.array([1, 2])</span>
<span class="sd">    &gt;&gt;&gt; solve_coo(m.data, (m.row, m.col), b, get_solver(&quot;SuperLU&quot;))</span>
<span class="sd">    array([0.09090909, 0.63636364])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">entries</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span><span class="o">.</span><span class="n">tocsc</span><span class="p">()</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="n">solver</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">rhs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="tofea.primitives.solve_coo_b_jvp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_coo_b_jvp</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Forward-mode derivative of :func:<code>solve_coo</code> with respect to <code>rhs</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/primitives.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_coo_b_jvp</span><span class="p">(</span>
    <span class="n">g</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">entries</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">indices</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">]],</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward-mode derivative of :func:`solve_coo` with respect to ``rhs``.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="tofea.primitives.solve_coo_b_vjp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_coo_b_vjp</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Reverse-mode derivative of :func:<code>solve_coo</code> for <code>rhs</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/primitives.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_coo_b_vjp</span><span class="p">(</span>
    <span class="n">ans</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">entries</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">indices</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">]],</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">NDArray</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reverse-mode derivative of :func:`solve_coo` for ``rhs``.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">vjp</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">vjp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="tofea.primitives.solve_coo_entries_jvp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_coo_entries_jvp</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Forward-mode derivative of :func:<code>solve_coo</code> with respect to <code>entries</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/primitives.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_coo_entries_jvp</span><span class="p">(</span>
    <span class="n">g</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">entries</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">indices</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">]],</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forward-mode derivative of :func:`solve_coo` with respect to ``entries``.&quot;&quot;&quot;</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">g</span><span class="p">,</span> <span class="n">indices</span><span class="p">))</span><span class="o">.</span><span class="n">tocsc</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">a</span> <span class="o">@</span> <span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="tofea.primitives.solve_coo_entries_vjp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve_coo_entries_vjp</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">entries</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">rhs</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Reverse-mode derivative of :func:<code>solve_coo</code> for <code>entries</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/primitives.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve_coo_entries_vjp</span><span class="p">(</span>
    <span class="n">ans</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">entries</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">indices</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">]],</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>  <span class="c1"># noqa: ARG001</span>
    <span class="n">solver</span><span class="p">:</span> <span class="n">Solver</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">NDArray</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reverse-mode derivative of :func:`solve_coo` for ``entries``.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">vjp</span><span class="p">(</span><span class="n">g</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">indices</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">ans</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">vjp</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="tofea.solvers"></a>
    <div class="doc doc-contents first">

        <p>Linear system solver abstractions.</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="tofea.solvers.Solver" class="doc doc-heading">
            <code>Solver</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract interface for linear solvers.</p>







              <details class="quote">
                <summary>Source code in <code>tofea/solvers.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Solver</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract interface for linear solvers.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="n">csc_matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">transpose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span> <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="tofea.solvers.SuperLU" class="doc doc-heading">
            <code>SuperLU</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Solver (tofea.solvers.Solver)" href="#tofea.solvers.Solver">Solver</a></code></p>


        <p><code>scipy.sparse.linalg.splu</code> wrapper.</p>







              <details class="quote">
                <summary>Source code in <code>tofea/solvers.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SuperLU</span><span class="p">(</span><span class="n">Solver</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;`scipy.sparse.linalg.splu` wrapper.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new ``SuperLU`` solver instance.&quot;&quot;&quot;</span>
        <span class="c1"># store solver-specific context on the instance to avoid cross-talk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;splu&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">splu</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="n">csc_matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the factorization of ``m``.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">[</span><span class="s2">&quot;factorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">[</span><span class="s2">&quot;splu&quot;</span><span class="p">](</span><span class="n">m</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">transpose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Solve the linear system.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">[</span><span class="s2">&quot;factorization&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="s2">&quot;T&quot;</span> <span class="k">if</span> <span class="n">transpose</span> <span class="k">else</span> <span class="s2">&quot;N&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove cached factorization.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;factorization&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="tofea.solvers.SuperLU.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a new <code>SuperLU</code> solver instance.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new ``SuperLU`` solver instance.&quot;&quot;&quot;</span>
    <span class="c1"># store solver-specific context on the instance to avoid cross-talk</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;splu&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">splu</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="tofea.solvers.SuperLU.clear" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Remove cached factorization.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove cached factorization.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;factorization&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="tofea.solvers.SuperLU.factor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">factor</span><span class="p">(</span><span class="n">m</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Compute the factorization of <code>m</code>.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span> <span class="n">csc_matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the factorization of ``m``.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">[</span><span class="s2">&quot;factorization&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">[</span><span class="s2">&quot;splu&quot;</span><span class="p">](</span><span class="n">m</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="tofea.solvers.SuperLU.solve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">solve</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Solve the linear system.</p>


            <details class="quote">
              <summary>Source code in <code>tofea/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rhs</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">transpose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Solve the linear system.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ctx</span><span class="p">[</span><span class="s2">&quot;factorization&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="s2">&quot;T&quot;</span> <span class="k">if</span> <span class="n">transpose</span> <span class="k">else</span> <span class="s2">&quot;N&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="tofea.solvers.get_solver" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return a solver instance by name.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>solver</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the solver implementation. Currently only <code>"SuperLU"</code> is
available.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">tofea.solvers</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_solver</span><span class="p">,</span> <span class="n">Solver</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">get_solver</span><span class="p">(</span><span class="s2">&quot;SuperLU&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">Solver</span><span class="p">)</span>
<span class="go">True</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>tofea/solvers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_solver</span><span class="p">(</span><span class="n">solver</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Solver</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a solver instance by name.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    solver</span>
<span class="sd">        Name of the solver implementation. Currently only ``&quot;SuperLU&quot;`` is</span>
<span class="sd">        available.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from tofea.solvers import get_solver, Solver</span>
<span class="sd">    &gt;&gt;&gt; s = get_solver(&quot;SuperLU&quot;)</span>
<span class="sd">    &gt;&gt;&gt; isinstance(s, Solver)</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">match</span> <span class="n">solver</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;SuperLU&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">SuperLU</span><span class="p">(</span>
                <span class="n">diag_pivot_thresh</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                <span class="n">permc_spec</span><span class="o">=</span><span class="s2">&quot;MMD_AT_PLUS_A&quot;</span><span class="p">,</span>
                <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;SymmetricMode&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
            <span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid solver: </span><span class="si">{</span><span class="n">solver</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>